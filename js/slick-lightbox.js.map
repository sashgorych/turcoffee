{"version":3,"names":[],"mappings":"","sources":["slick-lightbox.js"],"sourcesContent":["'use strict';\r\n(function ($) {\r\n    var SlickLightbox, defaults;\r\n    SlickLightbox = function () {\r\n        /*\r\n  The core class.\r\n   */\r\n        function SlickLightbox(element, options1) {\r\n            var slickLightbox;\r\n            this.options = options1;\r\n            /* Binds the plugin. */\r\n            this.$element = $(element);\r\n            this.didInit = false;\r\n            slickLightbox = this;\r\n            this.$element.on('click.slickLightbox', this.options.itemSelector, function (e) {\r\n                var $clickedItem, $items;\r\n                e.preventDefault();\r\n                $clickedItem = $(this);\r\n                $clickedItem.blur();\r\n                if (typeof slickLightbox.options.shouldOpen === 'function') {\r\n                    if (!slickLightbox.options.shouldOpen(slickLightbox, $clickedItem, e)) {\r\n                        return;\r\n                    }\r\n                }\r\n                $items = slickLightbox.$element.find(slickLightbox.options.itemSelector);\r\n                if (slickLightbox.elementIsSlick()) {\r\n                    $items = slickLightbox.filterOutSlickClones($items);\r\n                    $clickedItem = slickLightbox.handlePossibleCloneClick($clickedItem, $items);\r\n                }\r\n                return slickLightbox.init($items.index($clickedItem));\r\n            });\r\n        }\r\n        SlickLightbox.prototype.init = function (index) {\r\n            /* Creates the lightbox, opens it, binds events and calls `slick`. Accepts `index` of the element, that triggered it (so that we know, on which slide to start slick). */\r\n            this.didInit = true;\r\n            this.detectIE();\r\n            this.createModal();\r\n            this.bindEvents();\r\n            this.initSlick(index);\r\n            return this.open();\r\n        };\r\n        SlickLightbox.prototype.createModalItems = function () {\r\n            /* Creates individual slides to be used with slick. If `options.images` array is specified, it uses it's contents, otherwise loops through elements' `options.itemSelector`. */\r\n            var $items, createItem, itemTemplate, lazyPlaceholder, length, links;\r\n            lazyPlaceholder = this.options.lazyPlaceholder || 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\r\n            itemTemplate = function (source, caption, lazy) {\r\n                var imgSourceParams;\r\n                if (lazy === true) {\r\n                    imgSourceParams = ' data-lazy=\"' + source + '\" src=\"' + lazyPlaceholder + '\" ';\r\n                } else {\r\n                    imgSourceParams = ' src=\"' + source + '\" ';\r\n                }\r\n                return '<div class=\"slick-lightbox-slick-item\">\\n  <div class=\"slick-lightbox-slick-item-inner\">\\n    <img class=\"slick-lightbox-slick-img\" ' + imgSourceParams + ' />\\n    ' + caption + '\\n  </div>\\n</div>';\r\n            };\r\n            if (this.options.images) {\r\n                links = $.map(this.options.images, function (_this) {\r\n                    return function (img) {\r\n                        return itemTemplate(img, _this.options.lazy);\r\n                    };\r\n                }(this));\r\n            } else {\r\n                $items = this.filterOutSlickClones(this.$element.find(this.options.itemSelector));\r\n                length = $items.length;\r\n                createItem = function (_this) {\r\n                    return function (el, index) {\r\n                        var caption, info, src;\r\n                        info = {\r\n                            index: index,\r\n                            length: length\r\n                        };\r\n                        caption = _this.getElementCaption(el, info);\r\n                        src = _this.getElementSrc(el);\r\n                        return itemTemplate(src, caption, _this.options.lazy);\r\n                    };\r\n                }(this);\r\n                links = $.map($items, createItem);\r\n            }\r\n            return links;\r\n        };\r\n        SlickLightbox.prototype.createModal = function () {\r\n            /* Creates a `slick`-friendly modal. */\r\n            var html, links;\r\n            links = this.createModalItems();\r\n            html = '<div class=\"slick-lightbox slick-lightbox-hide-init' + (this.isIE ? ' slick-lightbox-ie' : '') + '\" style=\"background: ' + this.options.background + ';\">\\n  <div class=\"slick-lightbox-inner\">\\n    <div class=\"slick-lightbox-slick slick-caption-' + this.options.captionPosition + '\">' + links.join('') + '</div>\\n  <div>\\n<div>';\r\n            this.$modalElement = $(html);\r\n            this.$parts = {};\r\n            this.$parts['closeButton'] = $(this.options.layouts.closeButton);\r\n            this.$modalElement.find('.slick-lightbox-inner').append(this.$parts['closeButton']);\r\n            return $('body').append(this.$modalElement);\r\n        };\r\n        SlickLightbox.prototype.initSlick = function (index) {\r\n            /* Runs slick by default, using `options.slick` if provided. If `options.slick` is a function, it gets fired instead of us initializing slick. Merges in initialSlide option. */\r\n            var additional;\r\n            additional = { initialSlide: index };\r\n            if (this.options.lazy) {\r\n                additional.lazyLoad = 'ondemand';\r\n            }\r\n            if (this.options.slick != null) {\r\n                if (typeof this.options.slick === 'function') {\r\n                    this.slick = this.options.slick(this.$modalElement);\r\n                } else {\r\n                    this.slick = this.$modalElement.find('.slick-lightbox-slick').slick($.extend({}, this.options.slick, additional));\r\n                }\r\n            } else {\r\n                this.slick = this.$modalElement.find('.slick-lightbox-slick').slick(additional);\r\n            }\r\n            return this.$modalElement.trigger('init.slickLightbox');\r\n        };\r\n        SlickLightbox.prototype.open = function () {\r\n            /* Opens the lightbox. */\r\n            if (this.options.useHistoryApi) {\r\n                this.writeHistory();\r\n            }\r\n            this.$element.trigger('show.slickLightbox');\r\n            setTimeout(function (_this) {\r\n                return function () {\r\n                    return _this.$element.trigger('shown.slickLightbox');\r\n                };\r\n            }(this), this.getTransitionDuration());\r\n            return this.$modalElement.removeClass('slick-lightbox-hide-init');\r\n        };\r\n        SlickLightbox.prototype.close = function () {\r\n            /* Closes the lightbox and destroys it, maintaining the original element bindings. */\r\n            this.$element.trigger('hide.slickLightbox');\r\n            setTimeout(function (_this) {\r\n                return function () {\r\n                    return _this.$element.trigger('hidden.slickLightbox');\r\n                };\r\n            }(this), this.getTransitionDuration());\r\n            this.$modalElement.addClass('slick-lightbox-hide');\r\n            return this.destroy();\r\n        };\r\n        SlickLightbox.prototype.bindEvents = function () {\r\n            /* Binds global events. */\r\n            var resizeSlides;\r\n            resizeSlides = function (_this) {\r\n                return function () {\r\n                    var h;\r\n                    h = _this.$modalElement.find('.slick-lightbox-inner').height();\r\n                    _this.$modalElement.find('.slick-lightbox-slick-item').height(h);\r\n                    return _this.$modalElement.find('.slick-lightbox-slick-img, .slick-lightbox-slick-item-inner').css('max-height', Math.round(_this.options.imageMaxHeight * h));\r\n                };\r\n            }(this);\r\n            $(window).on('orientationchange.slickLightbox resize.slickLightbox', resizeSlides);\r\n            if (this.options.useHistoryApi) {\r\n                $(window).on('popstate.slickLightbox', function (_this) {\r\n                    return function () {\r\n                        return _this.close();\r\n                    };\r\n                }(this));\r\n            }\r\n            this.$modalElement.on('init.slickLightbox', resizeSlides);\r\n            this.$modalElement.on('destroy.slickLightbox', function (_this) {\r\n                return function () {\r\n                    return _this.destroy();\r\n                };\r\n            }(this));\r\n            this.$element.on('destroy.slickLightbox', function (_this) {\r\n                return function () {\r\n                    return _this.destroy(true);\r\n                };\r\n            }(this));\r\n            this.$parts['closeButton'].on('click.slickLightbox touchstart.slickLightbox', function (_this) {\r\n                return function (e) {\r\n                    e.preventDefault();\r\n                    return _this.close();\r\n                };\r\n            }(this));\r\n            if (this.options.closeOnEscape || this.options.navigateByKeyboard) {\r\n                $(document).on('keydown.slickLightbox', function (_this) {\r\n                    return function (e) {\r\n                        var code;\r\n                        code = e.keyCode ? e.keyCode : e.which;\r\n                        if (_this.options.navigateByKeyboard) {\r\n                            if (code === 37) {\r\n                                _this.slideSlick('left');\r\n                            } else if (code === 39) {\r\n                                _this.slideSlick('right');\r\n                            }\r\n                        }\r\n                        if (_this.options.closeOnEscape) {\r\n                            if (code === 27) {\r\n                                return _this.close();\r\n                            }\r\n                        }\r\n                    };\r\n                }(this));\r\n            }\r\n            if (this.options.closeOnBackdropClick) {\r\n                this.$modalElement.on('click.slickLightbox touchstart.slickLightbox', '.slick-lightbox-slick-img', function (e) {\r\n                    return e.stopPropagation();\r\n                });\r\n                return this.$modalElement.on('click.slickLightbox', '.slick-lightbox-slick-item', function (_this) {\r\n                    return function (e) {\r\n                        e.preventDefault();\r\n                        return _this.close();\r\n                    };\r\n                }(this));\r\n            }\r\n        };\r\n        SlickLightbox.prototype.slideSlick = function (direction) {\r\n            /* Moves the slick prev or next. */\r\n            if (direction === 'left') {\r\n                return this.slick.slick('slickPrev');\r\n            } else {\r\n                return this.slick.slick('slickNext');\r\n            }\r\n        };\r\n        SlickLightbox.prototype.detectIE = function () {\r\n            /* Detects usage of IE8 and lower. */\r\n            var ieversion;\r\n            this.isIE = false;\r\n            if (/MSIE (\\d+\\.\\d+);/.test(navigator.userAgent)) {\r\n                ieversion = new Number(RegExp.$1);\r\n                if (ieversion < 9) {\r\n                    return this.isIE = true;\r\n                }\r\n            }\r\n        };\r\n        SlickLightbox.prototype.getElementCaption = function (el, info) {\r\n            /* Returns caption for each slide based on the type of `options.caption`. */\r\n            var c;\r\n            if (!this.options.caption) {\r\n                return '';\r\n            }\r\n            c = function () {\r\n                switch (typeof this.options.caption) {\r\n                case 'function':\r\n                    return this.options.caption(el, info);\r\n                case 'string':\r\n                    return $(el).data(this.options.caption);\r\n                }\r\n            }.call(this);\r\n            return '<span class=\"slick-lightbox-slick-caption\">' + c + '</span>';\r\n        };\r\n        SlickLightbox.prototype.getElementSrc = function (el) {\r\n            /* Returns src for each slide image based on the type of `options.src`. */\r\n            switch (typeof this.options.src) {\r\n            case 'function':\r\n                return this.options.src(el);\r\n            case 'string':\r\n                return $(el).attr(this.options.src);\r\n            default:\r\n                return el.href;\r\n            }\r\n        };\r\n        SlickLightbox.prototype.unbindEvents = function () {\r\n            /* Unbinds global events. */\r\n            $(window).off('.slickLightbox');\r\n            $(document).off('.slickLightbox');\r\n            return this.$modalElement.off('.slickLightbox');\r\n        };\r\n        SlickLightbox.prototype.destroy = function (unbindAnchors) {\r\n            if (unbindAnchors == null) {\r\n                unbindAnchors = false;\r\n            }\r\n            /* Destroys the lightbox and unbinds global events. If `true` is passed as an argument, unbinds the original element as well. */\r\n            if (this.didInit) {\r\n                this.unbindEvents();\r\n                setTimeout(function (_this) {\r\n                    return function () {\r\n                        return _this.$modalElement.remove();\r\n                    };\r\n                }(this), this.options.destroyTimeout);\r\n            }\r\n            if (unbindAnchors) {\r\n                this.$element.off('.slickLightbox');\r\n                return this.$element.off('.slickLightbox', this.options.itemSelector);\r\n            }\r\n        };\r\n        SlickLightbox.prototype.destroyPrevious = function () {\r\n            /* Destroys lightboxes currently in DOM. */\r\n            return $('body').children('.slick-lightbox').trigger('destroy.slickLightbox');\r\n        };\r\n        SlickLightbox.prototype.getTransitionDuration = function () {\r\n            /* Detects the transition duration to know when to remove stuff from DOM etc. */\r\n            var duration;\r\n            if (this.transitionDuration) {\r\n                return this.transitionDuration;\r\n            }\r\n            duration = this.$modalElement.css('transition-duration');\r\n            if (typeof duration === 'undefined') {\r\n                return this.transitionDuration = 500;\r\n            } else {\r\n                return this.transitionDuration = duration.indexOf('ms') > -1 ? parseFloat(duration) : parseFloat(duration) * 1000;\r\n            }\r\n        };\r\n        SlickLightbox.prototype.writeHistory = function () {\r\n            /* Writes an empty state to the history API if supported. */\r\n            return typeof history !== 'undefined' && history !== null ? typeof history.pushState === 'function' ? history.pushState(null, null, '') : void 0 : void 0;\r\n        };\r\n        SlickLightbox.prototype.filterOutSlickClones = function ($items) {\r\n            /* Removes all slick clones from the set of elements. Only does so, if the target element is a slick slider. */\r\n            if (!this.elementIsSlick()) {\r\n                return $items;\r\n            }\r\n            return $items = $items.filter(function () {\r\n                var $item;\r\n                $item = $(this);\r\n                return !$item.hasClass('slick-cloned') && $item.parents('.slick-cloned').length === 0;\r\n            });\r\n        };\r\n        SlickLightbox.prototype.handlePossibleCloneClick = function ($clickedItem, $items) {\r\n            var href;\r\n            if (!this.elementIsSlick()) {\r\n                return $clickedItem;\r\n            }\r\n            if (!$clickedItem.closest('.slick-slide').hasClass('slick-cloned')) {\r\n                return $clickedItem;\r\n            }\r\n            href = $clickedItem.attr('href');\r\n            return $items.filter(function () {\r\n                return $(this).attr('href') === href;\r\n            }).first();\r\n        };\r\n        SlickLightbox.prototype.elementIsSlick = function () {\r\n            return this.$element.hasClass('slick-slider');\r\n        };\r\n        return SlickLightbox;\r\n    }();\r\n    defaults = {\r\n        background: 'rgba(0,0,0,.8)',\r\n        closeOnEscape: true,\r\n        closeOnBackdropClick: true,\r\n        destroyTimeout: 500,\r\n        itemSelector: 'a',\r\n        navigateByKeyboard: true,\r\n        src: false,\r\n        caption: false,\r\n        captionPosition: 'dynamic',\r\n        images: false,\r\n        slick: {},\r\n        useHistoryApi: false,\r\n        layouts: { closeButton: '<button type=\"button\" class=\"slick-lightbox-close\"></button>' },\r\n        shouldOpen: null,\r\n        imageMaxHeight: 0.9,\r\n        lazy: false\r\n    };\r\n    $.fn.slickLightbox = function (options) {\r\n        /* Fires the plugin. */\r\n        options = $.extend({}, defaults, options);\r\n        $(this).each(function () {\r\n            return this.slickLightbox = new SlickLightbox(this, options);\r\n        });\r\n        return this;\r\n    };\r\n    $.fn.unslickLightbox = function () {\r\n        /* Removes everything. */\r\n        return $(this).trigger('destroy.slickLightbox').each(function () {\r\n            return this.slickLightbox = null;\r\n        });\r\n    };\r\n}(jQuery));"],"file":"slick-lightbox.js"}